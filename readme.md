# PurchaseDelegator

The checkout portal contract enables buying a Kiwi NFT and delegating your
device's key at the same time

## Development

This contract relies on the existence of third-party contracts on Optimism.
Hence it is crucial to use `forge test -f` for the tests to pass.

## Deployment

- CREATE2 is used to deploy delegator2 to a deterministic address independent
  of chainId.
- `DEPLOYER`: 0x0000000000ffe8b47b3e2130213b802212439497
- `SALT`: 0x0000000000000000000000000000000000000000f00df00df00df00df00df00d
- `INITCODE`: 0x608060405234801561001057600080fd5b506105cd806100206000396000f3fe60806040526004361061001e5760003560e01c806340dd9ed714610023575b600080fd5b610036610031366004610321565b610038565b005b600061004261024e565b905080341015610065576040516349798bf960e11b815260040160405180910390fd5b60405163e58306f960e01b81523360048201526001602482018190527366747bdc903d17c586fa09ee5d6b54cc85bbea45917308b7ecfac2c5754abafb789c84f8fa37c9f088b09190839063e58306f9906044016020604051808303816000875af11580156100d8573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906100fc91906103a7565b50604051630175507f60e31b81526001600160a01b03831690630baa83f890610129908c906004016103c0565b600060405180830381600087803b15801561014357600080fd5b505af1158015610157573d6000803e3d6000fd5b5050604051731337e2624ffec537087c6774e9a18031cfeaf0a99250869150600081818185875af1925050503d80600081146101af576040519150601f19603f3d011682016040523d82523d6000602084013e6101b4565b606091505b505050600084346101c591906103cf565b905080156102425760405163e63d38ed60e01b815273d152f549545093347a162dce210e7293f145215090819063e63d38ed90849061020e908e908e908e908e906004016103f6565b6000604051808303818588803b15801561022757600080fd5b505af115801561023b573d6000803e3d6000fd5b5050505050505b50505050505050505050565b6000807366747bdc903d17c586fa09ee5d6b54cc85bbea459050806001600160a01b0316633474a4a66040518163ffffffff1660e01b815260040161016060405180830381865afa1580156102a7573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102cb91906104de565b6040015191505090565b60008083601f8401126102e757600080fd5b50813567ffffffffffffffff8111156102ff57600080fd5b6020830191508360208260051b850101111561031a57600080fd5b9250929050565b600080600080600060a0868803121561033957600080fd5b606086018781111561034a57600080fd5b8695503567ffffffffffffffff8082111561036457600080fd5b61037089838a016102d5565b9096509450608088013591508082111561038957600080fd5b50610396888289016102d5565b969995985093965092949392505050565b6000602082840312156103b957600080fd5b5051919050565b60608181019083833792915050565b818103818111156103f057634e487b7160e01b600052601160045260246000fd5b92915050565b6040808252810184905260008560608301825b8781101561043e5782356001600160a01b03811680821461042957600080fd5b83525060209283019290910190600101610409565b5083810360208501528481526001600160fb1b0385111561045e57600080fd5b8460051b915081866020830137016020019695505050505050565b604051610160810167ffffffffffffffff811182821017156104ab57634e487b7160e01b600052604160045260246000fd5b60405290565b805180151581146104c157600080fd5b919050565b805167ffffffffffffffff811681146104c157600080fd5b600061016082840312156104f157600080fd5b6104f9610479565b610502836104b1565b8152610510602084016104b1565b60208201526040830151604082015261052b606084016104c6565b606082015261053c608084016104c6565b608082015261054d60a084016104c6565b60a082015261055e60c084016104c6565b60c082015260e083810151908201526101008084015190820152610120808401519082015261014092830151928101929092525091905056fea2646970667358221220bb9275686273160bb7d27ab70547c01c7228f7565951e16fa9802c3b1083f42064736f6c63430008110033
- `ADDRESS`: 0x2F08c366D6C267BCeCF8B5A25089e1Ed66Eb4040
- Deployed to:
  - Optimism

## Updates and verifying on Etherscan

```
ETHERSCAN_API_KEY=abc forge verify-contract address PurchaseDelegator --watch --chain 10
```

## License

SPDX-License-Identifier: AGPL-3.0
